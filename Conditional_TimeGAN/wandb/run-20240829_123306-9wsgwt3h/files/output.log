[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:26: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:107: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:115: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:115: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/utils.py:95: GRUCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.GRUCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:117: MultiRNNCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.StackedRNNCells, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:118: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
WARNING:tensorflow:From /home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:559: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:565: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:575: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn.py:244: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.
WARNING:tensorflow:From /home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/contrib/layers/python/layers/layers.py:1866: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
ori_data shape : (24, 354)
BL_weekly_new_train dataset is ready.
24
[[0.00423729 0.01016949 0.00508475 ... 0.27966102 0.35169492 0.3220339 ]
 [0.01016949 0.00508475 0.00508475 ... 0.35169492 0.3220339  0.20084746]
 [0.00508475 0.00508475 0.00423729 ... 0.3220339  0.20084746 0.08898305]
 ...
 [0.25631769 0.21119134 0.13357401 ... 0.47833935 0.33212996 0.47111913]
 [0.21119134 0.13357401 0.28700361 ... 0.33212996 0.47111913 0.29061372]
 [0.13357401 0.28700361 0.15162455 ... 0.47111913 0.29061372 0.25812274]]
(24, 354)
norm_data_list
24
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[0.9999999999152541, 0.9999999999152541, 0.9999999999152541, 0.9999999999152541, 0.9999999999152541, 0.9999999999152541, 0.9999999999152541, 0.9999999999152541, 0.9999999999152541, 0.9999999999152541, 0.9999999999152541, 0.9999999999152541, 0.9999999998194946, 0.9999999998194946, 0.9999999998194946, 0.9999999998194946, 0.9999999998194946, 0.9999999998194946, 0.9999999998194946, 0.9999999998194946, 0.9999999998194946, 0.9999999998194946, 0.9999999998194946, 0.9999999998194946]
24 24
[[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:184: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:191: The name tf.losses.sigmoid_cross_entropy is deprecated. Please use tf.compat.v1.losses.sigmoid_cross_entropy instead.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:198: The name tf.losses.mean_squared_error is deprecated. Please use tf.compat.v1.losses.mean_squared_error instead.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:211: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:218: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.
WARNING:tensorflow:From /home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py:219: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.
step: 0/6000, e_loss: 0.2979
step: 1000/6000, e_loss: 0.0805
step: 2000/6000, e_loss: 0.0651
step: 3000/6000, e_loss: 0.0645
step: 4000/6000, e_loss: 0.0555
step: 5000/6000, e_loss: 0.0518
Finsh Embedding network
step: 0/6000, d_loss: 1.9034, g_loss_u: 0.8808, g_loss_s: 0.2936, g_loss_v: 0.3487
step: 1000/6000, d_loss: 1.702, g_loss_u: 0.7521, g_loss_s: 0.0351, g_loss_v: 0.2163
step: 2000/6000, d_loss: 0.5231, g_loss_u: 2.9605, g_loss_s: 0.0186, g_loss_v: 0.199
step: 3000/6000, d_loss: 1.2729, g_loss_u: 1.3802, g_loss_s: 0.0162, g_loss_v: 0.1532
step: 4000/6000, d_loss: 1.2526, g_loss_u: 1.2504, g_loss_s: 0.0107, g_loss_v: 0.1383
step: 5000/6000, d_loss: 1.4199, g_loss_u: 0.7498, g_loss_s: 0.0093, g_loss_v: 0.1307
Traceback (most recent call last):
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1365, in _do_call
    return fn(*args)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1350, in _run_fn
    target_list, run_metadata)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1443, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: ConcatOp : Dimensions of inputs should match: shape[0] = [24,354,1] vs. shape[1] = [12,354,1]
	 [[{{node generator/concat}}]]
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "main_timegan.py", line 221, in <module>
    ori_data, generated_data, metrics = main(args)
  File "main_timegan.py", line 94, in main
    generated_data = timegan_conditional(ori_data, categories, parameters)
  File "/home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py", line 264, in timegan_conditional
    generated_data_curr = sess.run(X_hat, feed_dict={Z: Z_mb, T: ori_time, C: categories_one_hot})
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 956, in run
    run_metadata_ptr)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1180, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1359, in _do_run
    run_metadata)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/client/session.py", line 1384, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: ConcatOp : Dimensions of inputs should match: shape[0] = [24,354,1] vs. shape[1] = [12,354,1]
	 [[node generator/concat (defined at /home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py:1748) ]]
Original stack trace for 'generator/concat':
  File "main_timegan.py", line 221, in <module>
    ori_data, generated_data, metrics = main(args)
  File "main_timegan.py", line 94, in main
    generated_data = timegan_conditional(ori_data, categories, parameters)
  File "/home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py", line 168, in timegan_conditional
    E_hat = generator(Z, T, C)
  File "/home/langleman/Conditional_TimeGAN/conditional_timegan_gpt.py", line 136, in generator
    Z_concat = tf.concat([Z, tf.tile(tf.expand_dims(C, 1), [1, max_seq_len, 1])], axis=2)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/util/dispatch.py", line 180, in wrapper
    return target(*args, **kwargs)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/ops/array_ops.py", line 1420, in concat
    return gen_array_ops.concat_v2(values=values, axis=axis, name=name)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/ops/gen_array_ops.py", line 1257, in concat_v2
    "ConcatV2", values=values, axis=axis, name=name)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/framework/op_def_library.py", line 794, in _apply_op_helper
    op_def=op_def)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py", line 3357, in create_op
    attrs, op_def, compute_device)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py", line 3426, in _create_op_internal
    op_def=op_def)
  File "/home/langleman/.conda/envs/timegan/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()